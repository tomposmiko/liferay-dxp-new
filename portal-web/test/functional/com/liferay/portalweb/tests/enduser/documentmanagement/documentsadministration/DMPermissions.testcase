@component-name = "portal-document-management"
definition {

	property custom.properties = "jsonws.web.service.paths.excludes=${line.separator}dl.actions.visible=true";
	property portal.release = "true";
	property portal.upstream = "true";
	property testray.main.component.name = "Document Management";

	setUp {
		TestCase.setUpPortalInstance();

		User.firstLoginPG();
	}

	tearDown {
		var testPortalInstance = PropsUtil.get("test.portal.instance");

		if (${testPortalInstance} == "true") {
			PortalInstances.tearDownCP();
		}
		else {
			JSONUser.tearDownNonAdminUsers();

			Role.tearDownCP();

			Site.tearDownCP();

			PagesAdmin.tearDownCP();

			DMFolder.tearDownCP();

			DMDocument.tearDownCP();
		}
	}

	@priority = 5
	@refactordone
	test CanAddAddDocumentPermissionsForRegRole {
		property portal.acceptance = "true";

		Permissions.setUpRegRolePG(
			pageName = "Documents and Media Page",
			portletName = "Documents and Media",
			roleTitle = "Regrole Name",
			userEmailAddress = "userea@liferay.com",
			userFirstName = "userfn",
			userLastName = "userln",
			userScreenName = "usersn");

		Permissions.definePermissionViaJSONAPI(
			resourceAction = "ADD_DOCUMENT",
			resourceName = "com.liferay.document.library",
			roleTitle = "Regrole Name");

		Navigator.gotoPage(pageName = "Documents and Media Page");

		LexiconEntry.changeDisplayStyle(displayStyle = "list");

		User.logoutAndLoginPG(
			userLoginEmailAddress = "userea@liferay.com",
			userLoginFullName = "userfn userln");

		Navigator.gotoPage(pageName = "Documents and Media Page");

		DMDocument.addPG(
			dmDocumentFile = "Document_1.doc",
			dmDocumentTitle = "Document_1.doc");
	}

	@priority = 4
	@refactordone
	test CanAddAddDocumentPermissionsForSiteMember {
		property portal.acceptance = "true";

		Permissions.setUpSiteMemberRoleLoginUserPG(
			pageName = "Documents and Media Page",
			portletName = "Documents and Media",
			siteName = "Site Name",
			userEmailAddress = "userea@liferay.com",
			userFirstName = "userfn",
			userLastName = "userln",
			userLoginEmailAddress = "userea@liferay.com",
			userLoginFullName = "userfn userln",
			userScreenName = "usersn");

		User.logoutAndLoginPG(
			userLoginEmailAddress = "test@liferay.com",
			userLoginFullName = "Test Test");

		PermissionsInline.gotoDocumentsAndMediaHomeFolderPG(
			pageName = "Documents and Media Page",
			siteName = "Site Name",
			siteURLTemp = "true");

		Role.definePermissionPG(
			permissionDefinitionKey = "INLINE_PERMISSIONS_ADD_DOCUMENT_CHECKBOX",
			roleTitle = "Site Member");

		User.logoutAndLoginPG(
			userLoginEmailAddress = "userea@liferay.com",
			userLoginFullName = "userfn userln");

		Navigator.gotoSitePage(
			pageName = "Documents and Media Page",
			siteName = "Site Name");

		DMDocument.addPG(
			dmDocumentFile = "Document_2.doc",
			dmDocumentTitle = "Document_2.doc");
	}

	@priority = 4
	@refactordone
	test CanAddDocumentAsSiteRoleWithPermissions {
		property portal.acceptance = "true";

		Permissions.setUpSiteRoleLoginUserPG(
			page = "Public Pages",
			pageName = "Documents and Media Page",
			portletName = "Documents and Media",
			roleTitle = "Roles Siterole Name",
			roleType = "Site",
			siteName = "Site Name",
			userEmailAddress = "userea@liferay.com",
			userFirstName = "userfn",
			userLastName = "userln",
			userLoginEmailAddress = "test@liferay.com",
			userLoginFullName = "Test Test",
			userScreenName = "usersn");

		Navigator.gotoSitePage(
			pageName = "Documents and Media Page",
			siteName = "Site Name");

		DMDocument.enableActionsMenuOnPortlet();

		Refresh();

		Permissions.definePermissionViaJSONAPI(
			resourceAction = "ADD_DOCUMENT",
			resourceName = "com.liferay.document.library",
			roleTitle = "Roles Siterole Name",
			roleType = "site");

		User.logoutAndLoginPG(
			userLoginEmailAddress = "userea@liferay.com",
			userLoginFullName = "userfn userln");

		Navigator.gotoSitePage(
			pageName = "Documents and Media Page",
			siteName = "Site Name");

		DMDocument.addPG(
			dmDocumentFile = "Document_1.doc",
			dmDocumentTitle = "Document_1.doc");
	}

	@description = "This is a test for LPS-128366, it ensures that the folder permissions are removed after removing permissions during folder addition."
	@priority = 3
	@refactordone
	test CanAddFolderWithViewOnlyByOwnerPermissions {
		JSONLayout.addPublicLayout(
			groupName = "Guest",
			layoutName = "Documents and Media Page");

		JSONLayout.addWidgetToPublicLayout(
			column = 1,
			groupName = "Guest",
			layoutName = "Documents and Media Page",
			widgetName = "Documents and Media");

		Navigator.gotoPage(pageName = "Documents and Media Page");

		LexiconEntry.changeDisplayStyle(displayStyle = "list");

		Navigator.gotoPage(pageName = "Documents and Media Page");

		DMFolder.addPG(
			addOrRemoveViewPermission = "Remove",
			dmFolderDescription = "DM Folder Description",
			dmFolderName = "DM Folder Name",
			permissionDefinitionKeyList = "ADD_SUBFOLDER,ADD_SHORTCUT,ADD_DOCUMENT,SUBSCRIBE",
			roleTitle = "Site Member",
			viewableBy = "Owner");

		Navigator.gotoPage(pageName = "Documents and Media Page");

		DMFolder.viewFolderPermissionsPG(dmFolder = "DM Folder Name");

		for (var permissionDefinitionKey : list "CONFIGURATION_PERMISSIONS_ADD_SUBFOLDER_CHECKBOX,CONFIGURATION_PERMISSIONS_ADD_SHORTCUT_CHECKBOX,CONFIGURATION_PERMISSIONS_ADD_DOCUMENT_CHECKBOX,CONFIGURATION_PERMISSIONS_SUBSCRIBE_CHECKBOX,CONFIGURATION_PERMISSIONS_VIEW_CHECKBOX") {
			PermissionsInline.viewPermissionsRemoved(
				permissionDefinitionKey = ${permissionDefinitionKey},
				roleTitle = "Site Member");
		}

		for (var permissionDefinitionKey : list "CONFIGURATION_PERMISSIONS_VIEW_CHECKBOX,CONFIGURATION_PERMISSIONS_ACCESS_CHECKBOX") {
			PermissionsInline.viewPermissionsRemoved(
				permissionDefinitionKey = ${permissionDefinitionKey},
				roleTitle = "Guest");
		}
	}

	@description = "This is a test for LPS-90864. It checks that a site member can add shortcut to folder with permissions."
	@priority = 4
	test CanAddShortcutToFolderAsSiteMemberWithPermissions {
		JSONUser.addUser(
			userEmailAddress = "userea@liferay.com",
			userFirstName = "userfn",
			userLastName = "userln",
			userScreenName = "usersn");

		JSONUser.setFirstPassword(
			agreeToTermsAndAnswerReminderQuery = "true",
			requireReset = "false",
			userEmailAddress = "userea@liferay.com");

		JSONGroup.addGroup(groupName = "Site Name");

		JSONUser.addUserToSite(
			groupName = "Site Name",
			userEmailAddress = "userea@liferay.com");

		JSONLayout.addPublicLayout(
			groupName = "Site Name",
			layoutName = "Documents and Media Page");

		JSONLayout.addWidgetToPublicLayout(
			column = 2,
			groupName = "Site Name",
			layoutName = "Documents and Media Page",
			widgetName = "Documents and Media");

		JSONDocument.addFileWithUploadedFile(
			dmDocumentDescription = "DM Document Description",
			dmDocumentTitle = "DM Document Title",
			groupName = "Site Name",
			mimeType = "text/plain",
			sourceFileName = "Document_1.txt");

		JSONFolder.addFolder(
			dmFolderDescription = "DM Folder Description",
			dmFolderName = "DM Folder Name",
			groupName = "Site Name");

		Navigator.gotoSitePage(
			pageName = "Documents and Media Page",
			siteName = "Site Name");

		DMDocument.enableActionsMenuOnPortlet();

		Navigator.gotoSitePage(
			pageName = "Documents and Media Page",
			siteName = "Site Name");

		DMNavigator.gotoFolderPermissions(dmFolderName = "DM Folder Name");

		PermissionsInline.addOrRemoveAnyPermissionsFromSpecificRole(
			addOrRemoveViewPermission = "Add",
			permissionsKeyList = "INLINE_PERMISSIONS_ADD_SHORTCUT_CHECKBOX",
			roleTitle = "Site Member");

		User.logoutAndLoginPG(
			userLoginEmailAddress = "userea@liferay.com",
			userLoginFullName = "userfn userln");

		Navigator.gotoSitePage(
			pageName = "Documents and Media Page",
			siteName = "Site Name");

		DMNavigator.gotoFolder(dmFolderName = "DM Folder Name");

		DMDocument.addDMShortcutPG(
			dmDocumentTitle = "DM Document Title",
			siteName = "Site Name");

		DMDocument.viewPG(dmDocumentTitle = "DM Document Title");
	}

	@priority = 4
	@refactordone
	test CannotAddDocumentAsSiteRoleWithoutPermissions {
		property portal.acceptance = "true";

		Permissions.setUpSiteRoleLoginUserPG(
			page = "Public Pages",
			pageName = "Documents and Media Page",
			portletName = "Documents and Media",
			roleTitle = "Roles Siterole Name",
			roleType = "Site",
			siteName = "Site Name",
			userEmailAddress = "userea@liferay.com",
			userFirstName = "userfn",
			userLastName = "userln",
			userLoginEmailAddress = "test@liferay.com",
			userLoginFullName = "Test Test",
			userScreenName = "usersn");

		PermissionsInline.gotoDocumentsAndMediaHomeFolderPG(
			pageName = "Documents and Media Page",
			siteName = "Site Name",
			siteURLTemp = "true");

		Role.removePermissionPG(
			permissionDefinitionKey = "INLINE_PERMISSIONS_ADD_DOCUMENT_CHECKBOX",
			roleTitle = "Site Member");

		User.logoutAndLoginPG(
			userLoginEmailAddress = "userea@liferay.com",
			userLoginFullName = "userfn userln");

		Navigator.gotoSitePage(
			pageName = "Documents and Media Page",
			siteName = "Site Name");

		Portlet.clickPortletPlusIconPG(portletName = "Documents and Media");

		MenuItem.viewNotPresent(menuItem = "File Upload");
	}

	@priority = 5
	@refactordone
	test CannotDeleteDMFolderAsRegularRoleWithoutPermission {
		property portal.acceptance = "true";
		property testray.component.names = "Training";

		JSONGroup.addGroup(groupName = "Site Name");

		Permissions.setUpRegRoleLoginUserPG(
			pageName = "Documents and Media Page",
			portletName = "Documents and Media",
			roleTitle = "Regrole Name",
			siteName = "Site Name",
			userEmailAddress = "userea@liferay.com",
			userFirstName = "userfn",
			userLastName = "userln",
			userLoginEmailAddress = "test@liferay.com",
			userLoginFullName = "Test Test",
			userScreenName = "usersn");

		Navigator.gotoSitePage(
			pageName = "Documents and Media Page",
			siteName = "Site Name");

		DMFolder.addDMFolderLoginUserPG(
			dmFolderDescription = "DM Folder Description",
			dmFolderName = "DM Folder Name",
			pageName = "Documents and Media Page",
			siteName = "Site Name",
			userLoginEmailAddress = "userea@liferay.com",
			userLoginFullName = "userfn userln");

		User.logoutAndLoginPG(
			userLoginEmailAddress = "userea@liferay.com",
			userLoginFullName = "userfn userln");

		Navigator.gotoSitePage(
			pageName = "Documents and Media Page",
			siteName = "Site Name");

		AssertTextEquals(
			key_dmFolderName = "DM Folder Name",
			locator1 = "DocumentsAndMedia#DESCRIPTIVE_LIST_FOLDER_TITLE",
			value1 = "DM Folder Name");

		Click(
			key_dmFolderName = "DM Folder Name",
			locator1 = "DocumentsAndMedia#DESCRIPTIVE_LIST_VERTICAL_ELLIPSIS");

		MenuItem.viewNotPresent(menuItem = "Delete");
	}

	@description = "This is a use case for LPS-43104."
	@priority = 5
	@refactordone
	test CannotViewDocumentAsGuestWithoutPermissions {
		property portal.acceptance = "true";

		JSONGroup.addGroup(groupName = "Site Name");

		JSONLayout.addPublicLayout(
			groupName = "Site Name",
			layoutName = "Documents and Media Page");

		JSONLayout.addWidgetToPublicLayout(
			column = 1,
			groupName = "Site Name",
			layoutName = "Documents and Media Page",
			widgetName = "Documents and Media");

		JSONDocument.addFileWithUploadedFile(
			dmDocumentDescription = "DM Document Description",
			dmDocumentTitle = "Document_1.doc",
			groupName = "Site Name",
			mimeType = "application/msword",
			sourceFileName = "Document_1.doc");

		Navigator.openSitePage(
			pageName = "Documents and Media Page",
			siteName = "Site Name");

		PermissionsInline.gotoDocumentsAndMediaDocumentPG(
			dmDocumentTitle = "Document_1.doc",
			pageName = "Documents and Media Page");

		Role.removePermissionPG(
			permissionDefinitionKey = "CONTENT_PERMISSIONS_VIEW_CHECKBOX",
			roleTitle = "Guest");

		User.logoutPG();

		Navigator.openSitePage(
			pageName = "Documents and Media Page",
			siteName = "Site Name");

		LexiconEntry.changeDisplayStyle(displayStyle = "list");

		DMPortlet.viewDefaultPG();
	}

	@description = "This test covers LPS-118268. It ensures that the user without document view permission can not view the document via the display page."
	@priority = 4
	@refactordone
	test CannotViewDocumentInDisplayPageWithoutPermissions {
		property portal.acceptance = "true";

		JSONLayoutpagetemplate.addDisplayPageTemplateEntry(
			contentType = "Document",
			displayPageTemplateEntryName = "Display Page Name",
			groupName = "Guest",
			subType = "Basic Document");

		DisplayPageTemplatesAdmin.openDisplayPagesAdmin(siteURLKey = "guest");

		DisplayPageTemplatesAdmin.gotoDisplayPage(displayPageName = "Display Page Name");

		PageEditor.addWidget(portletName = "Documents and Media");

		PageEditor.publish();

		DisplayPageTemplatesAdmin.markDisplayPageAsDefault(displayPageName = "Display Page Name");

		DMNavigator.openDocumentsAndMediaAdmin(siteURLKey = "guest");

		DMDocument.addCP(
			dmDocumentDescription = "DM Document Description",
			dmDocumentFile = "Document_1.jpg",
			dmDocumentTitle = "DM Document Title");

		var dmFileEntryId = JSONDocument.getFileEntryId(
			dmDocumentTitle = "DM Document Title",
			groupName = "Guest");

		DMNavigator.openDocumentsAndMediaAdmin(siteURLKey = "guest");

		DMNavigator.gotoDocumentPermissionsCP(dmDocumentTitle = "DM Document Title");

		PermissionsInline.addOrRemoveViewPermissionFromAllRoles(
			addOrRemoveViewPermission = "Remove",
			roleList = "guest");

		User.logoutPG();

		Navigator.openWithAppendToBaseURL(urlAppend = "group/guest/d/${dmFileEntryId}");

		AssertElementNotPresent(
			key_dmDocumentTitle = "DM Document Title",
			locator1 = "DocumentsAndMedia#DESCRIPTIVE_LIST_DOCUMENT_TITLE");

		User.viewLoginPG(loginPg = "Full Screen");
	}

	@description = "This ensures that the user can create document viewable only by the owner."
	@priority = 4
	@refactordone
	test CannotViewDocumentWithOwnerAccessOnly {
		property portal.acceptance = "true";

		JSONGroup.addGroup(groupName = "Site Name");

		JSONUser.addUser(
			userEmailAddress = "userea@liferay.com",
			userFirstName = "userfn",
			userLastName = "userln",
			userScreenName = "usersn");

		JSONUser.setFirstPassword(
			agreeToTermsAndAnswerReminderQuery = "true",
			requireReset = "false",
			userEmailAddress = "userea@liferay.com");

		JSONLayout.addPublicLayout(
			groupName = "Site Name",
			layoutName = "Documents and Media Page");

		JSONLayout.addWidgetToPublicLayout(
			column = 1,
			groupName = "Site Name",
			layoutName = "Documents and Media Page",
			widgetName = "Documents and Media");

		JSONDocument.addFileWithUploadedFile(
			dmDocumentDescription = "DM Document Description",
			dmDocumentTitle = "Document_1.doc",
			groupName = "Site Name",
			mimeType = "text/plain",
			sourceFileName = "Document_1.doc");

		JSONUser.addUserToSite(
			groupName = "Site Name",
			userEmailAddress = "userea@liferay.com");

		Navigator.openSitePage(
			pageName = "Documents and Media Page",
			siteName = "Site Name");

		DMDocument.enableActionsMenuOnPortlet();

		Refresh();

		PermissionsInline.gotoDocumentsAndMediaDocumentPG(
			dmDocumentTitle = "Document_1.doc",
			pageName = "Documents and Media Page");

		for (var roleTitle : list "guest,site-member") {
			Role.removePermissionPG(
				permissionDefinitionKey = "CONTENT_PERMISSIONS_VIEW_CHECKBOX",
				roleTitle = ${roleTitle});
		}

		Navigator.openSitePage(
			pageName = "Documents and Media Page",
			siteName = "Site Name");

		DMDocument.viewAllPG(
			dmDocumentDescription = "DM Document Description",
			dmDocumentTitle = "Document_1.doc",
			dmDocumentType = "Basic Document");

		User.logoutPG();

		Navigator.openSitePage(
			pageName = "Documents and Media Page",
			siteName = "Site Name");

		LexiconEntry.changeDisplayStyle(displayStyle = "list");

		DMPortlet.viewDefaultPG();

		User.loginUserPG(userEmailAddress = "userea@liferay.com");

		Navigator.openSitePage(
			pageName = "Documents and Media Page",
			siteName = "Site Name");

		DMPortlet.viewDefaultPG();
	}

	@priority = 4
	@refactordone
	test CannotViewFolderAsGuestWithNoPermissions {
		property portal.acceptance = "true";

		JSONGroup.addGroup(groupName = "Site Name");

		JSONLayout.addPublicLayout(
			groupName = "Site Name",
			layoutName = "Documents and Media Page");

		JSONLayout.addWidgetToPublicLayout(
			column = 1,
			groupName = "Site Name",
			layoutName = "Documents and Media Page",
			widgetName = "Documents and Media");

		JSONFolder.addFolder(
			dmFolderDescription = "DM Folder Description",
			dmFolderName = "DM Folder Name",
			groupName = "Site Name");

		DMNavigator.openDocumentsAndMediaAdmin(siteURLKey = "site-name");

		DMNavigator.gotoFolderPermissions(dmFolderName = "DM Folder Name");

		PermissionsInline.addOrRemoveAccessPermissionFromAllRoles(
			addOrRemoveViewPermission = "Add",
			roleList = "guest");

		Role.removePermissionPG(
			permissionDefinitionKey = "CONTENT_PERMISSIONS_VIEW_CHECKBOX",
			roleTitle = "Guest");

		User.logoutPG();

		Navigator.openSitePage(
			pageName = "Documents and Media Page",
			siteName = "Site Name");

		DMPortlet.viewDefaultPG();
	}

	@priority = 5
	@refactordone
	test CannotViewFolderAsOrganizationMemberWithoutPermissions {
		property portal.acceptance = "true";
		property testray.component.names = "Training";

		JSONUser.addUser(
			userEmailAddress = "userea@liferay.com",
			userFirstName = "userfn",
			userLastName = "userln",
			userScreenName = "usersn");

		JSONUser.setFirstPassword(
			agreeToTermsAndAnswerReminderQuery = "true",
			requireReset = "false",
			userEmailAddress = "userea@liferay.com");

		JSONOrganization.addOrganization(organizationName = "Organization Name");

		ApplicationsMenu.gotoPortlet(
			category = "Users",
			panel = "Control Panel",
			portlet = "Users and Organizations");

		UsersAndOrganizationsNavigator.gotoOrganizations();

		Organization.assignUser(
			orgName = "Organization Name",
			userFirstName = "userfn",
			userLastName = "userln",
			userScreenName = "usersn");

		Organization.openOrganizationsAdmin();

		Organization.addSiteCP(orgName = "Organization Name");

		JSONLayout.addPublicLayout(
			groupName = "Organization Name",
			layoutName = "Documents and Media Page");

		JSONLayout.addWidgetToPublicLayout(
			column = 1,
			groupName = "Organization Name",
			layoutName = "Documents and Media Page",
			widgetName = "Documents and Media");

		Navigator.gotoSitePage(
			pageName = "Documents and Media Page",
			siteName = "Organization Name");

		DMDocument.enableActionsMenuOnPortlet();

		Refresh();

		DMFolder.addPG(
			dmFolderDescription = "DM Folder Description",
			dmFolderName = "DM Folder Name");

		ProductMenu.gotoPortlet(
			category = "Content & Data",
			portlet = "Documents and Media");

		DMNavigator.gotoFolderPermissions(dmFolderName = "DM Folder Name");

		for (var permissionsInLineUncheckListsCount : list "INLINE_PERMISSIONS_ADD_SUBFOLDER_CHECKBOX,INLINE_PERMISSIONS_ADD_SHORTCUT_CHECKBOX,INLINE_PERMISSIONS_ADD_DOCUMENT_CHECKBOX,INLINE_PERMISSIONS_SUBSCRIBE_CHECKBOX,INLINE_PERMISSIONS_VIEW_CHECKBOX") {
			Role.removePermissionPG(
				permissionDefinitionKey = ${permissionsInLineUncheckListsCount},
				roleTitle = "Site Member");
		}

		Role.removePermissionPG(
			permissionDefinitionKey = "INLINE_PERMISSIONS_VIEW_CHECKBOX",
			roleTitle = "Guest");

		IFrame.selectTopFrame();

		User.logoutAndLoginPG(
			userLoginEmailAddress = "userea@liferay.com",
			userLoginFullName = "userfn userln");

		Navigator.gotoSitePage(
			pageName = "Documents and Media Page",
			siteName = "Organization Name");

		DMPortlet.viewDefaultPG();
	}

	@priority = 5
	@refactordone
	test CannotViewFolderAsSiteMember {
		property portal.acceptance = "true";

		JSONUser.addUser(
			userEmailAddress = "userea@liferay.com",
			userFirstName = "userfn",
			userLastName = "userln",
			userScreenName = "usersn");

		JSONUser.setFirstPassword(
			agreeToTermsAndAnswerReminderQuery = "true",
			requireReset = "false",
			userEmailAddress = "userea@liferay.com");

		JSONGroup.addGroup(groupName = "Site Name");

		JSONLayout.addPublicLayout(
			groupName = "Site Name",
			layoutName = "Documents and Media Page");

		JSONLayout.addWidgetToPublicLayout(
			column = 1,
			groupName = "Site Name",
			layoutName = "Documents and Media Page",
			widgetName = "Documents and Media");

		ApplicationsMenu.gotoPortlet(
			category = "Users",
			panel = "Control Panel",
			portlet = "Users and Organizations");

		User.editUserSiteCP(
			siteName = "Site Name",
			userScreenName = "usersn");

		JSONFolder.addFolder(
			dmFolderDescription = "DM Folder Description",
			dmFolderName = "DM Folder Name",
			groupName = "Site Name");

		DMNavigator.openDocumentsAndMediaAdmin(siteURLKey = "site-name");

		DMNavigator.gotoFolderPermissions(dmFolderName = "DM Folder Name");

		PermissionsInline.addOrRemoveAccessPermissionFromAllRoles(
			addOrRemoveViewPermission = "Add",
			roleList = "guest");

		User.logoutAndLoginPG(
			userLoginEmailAddress = "userea@liferay.com",
			userLoginFullName = "userfn userln");

		Navigator.gotoSitePage(
			pageName = "Documents and Media Page",
			siteName = "Site Name");

		LexiconEntry.changeDisplayStyle(displayStyle = "list");

		DMNavigator.gotoFolder(dmFolderName = "DM Folder Name");

		DMFolder.addPG(
			dmFolderDescription = "DM Subfolder1 Description",
			dmFolderName = "SubFolder1 Name");

		DMNavigator.gotoFolder(dmFolderName = "SubFolder1 Name");

		DMDocument.addPG(
			dmDocumentFile = "Document_1.doc",
			dmDocumentTitle = "Document_1.doc");

		User.logoutAndLoginPG(
			userLoginEmailAddress = "test@liferay.com",
			userLoginFullName = "Test Test");

		DMNavigator.openDocumentsAndMediaAdmin(siteURLKey = "site-name");

		DMNavigator.gotoFolderPermissions(dmFolderName = "DM Folder Name");

		for (var permissionsInLineUncheckListsCount : list "INLINE_PERMISSIONS_ADD_SUBFOLDER_CHECKBOX,INLINE_PERMISSIONS_ADD_SHORTCUT_CHECKBOX,INLINE_PERMISSIONS_ADD_DOCUMENT_CHECKBOX,INLINE_PERMISSIONS_SUBSCRIBE_CHECKBOX,INLINE_PERMISSIONS_VIEW_CHECKBOX") {
			Role.removePermissionPG(
				permissionDefinitionKey = ${permissionsInLineUncheckListsCount},
				roleTitle = "Site Member");
		}

		Role.removePermissionPG(
			permissionDefinitionKey = "INLINE_PERMISSIONS_VIEW_CHECKBOX",
			roleTitle = "Guest");

		IFrame.selectTopFrame();

		User.logoutAndLoginPG(
			userLoginEmailAddress = "userea@liferay.com",
			userLoginFullName = "userfn userln");

		Navigator.gotoSitePage(
			pageName = "Documents and Media Page",
			siteName = "Site Name");

		DMPortlet.viewDefaultPG();
	}

	@priority = 5
	@refactordone
	test CannotViewMultipleDocumentsAsSiteMember {
		property portal.acceptance = "true";
		property testray.component.names = "Training";

		JSONUser.addUser(
			userEmailAddress = "userea@liferay.com",
			userFirstName = "userfn",
			userLastName = "userln",
			userScreenName = "usersn");

		JSONUser.setFirstPassword(
			agreeToTermsAndAnswerReminderQuery = "true",
			requireReset = "false",
			userEmailAddress = "userea@liferay.com");

		JSONGroup.addGroup(groupName = "Site Name");

		JSONUser.addUserToSite(
			groupName = "Site Name",
			userEmailAddress = "userea@liferay.com");

		JSONLayout.addPublicLayout(
			groupName = "Site Name",
			layoutName = "Documents and Media Page");

		JSONLayout.addWidgetToPublicLayout(
			column = 2,
			groupName = "Site Name",
			layoutName = "Documents and Media Page",
			widgetName = "Documents and Media");

		Navigator.gotoSitePage(
			pageName = "Documents and Media Page",
			siteName = "Site Name");

		DMDocument.enableActionsMenuOnPortlet();

		Refresh();

		DMDocument.addMultiplePG(
			dmDocumentFileList = "Document_1.jpeg,Document_2.docx,Document_3.mp3",
			viewableBy = "Owner");

		User.logoutPG();

		User.loginUserPG(
			password = "test",
			userEmailAddress = "userea@liferay.com");

		Navigator.gotoSitePage(
			pageName = "Documents and Media Page",
			siteName = "Site Name");

		for (var dmDocumentTitle : list "Document_1.jpeg,Document_2.docx,Document_3.mp3") {
			DMDocument.cannotViewCP(dmDocumentTitle = ${dmDocumentTitle});
		}
	}

	@priority = 5
	@refactordone
	test CanRemoveAddDocumentPermissionsForRegRole {
		property portal.acceptance = "true";

		Permissions.setUpRegRolePG(
			pageName = "Documents and Media Page",
			portletName = "Documents and Media",
			roleTitle = "Regrole Name",
			userEmailAddress = "userea@liferay.com",
			userFirstName = "userfn",
			userLastName = "userln",
			userScreenName = "usersn");

		Permissions.definePermissionViaJSONAPI(
			resourceAction = "ADD_DOCUMENT",
			resourceName = "com.liferay.document.library",
			roleTitle = "Regrole Name");

		Permissions.removePermissionViaAPI(
			resourceAction = "ADD_DOCUMENT",
			resourceName = "com.liferay.document.library",
			roleTitle = "Regrole Name");

		User.logoutAndLoginPG(
			userLoginEmailAddress = "userea@liferay.com",
			userLoginFullName = "userfn userln");

		Navigator.gotoPage(pageName = "Documents and Media Page");

		AssertElementNotPresent(locator1 = "Toolbar#ADD");
	}

	@priority = 4
	@refactordone
	test CanRemoveAddDocumentPermissionsForSiteMember {
		property portal.acceptance = "true";

		Permissions.setUpSiteMemberRoleLoginUserPG(
			pageName = "Documents and Media Page",
			portletName = "Documents and Media",
			siteName = "Site Name",
			userEmailAddress = "userea@liferay.com",
			userFirstName = "userfn",
			userLastName = "userln",
			userLoginEmailAddress = "userea@liferay.com",
			userLoginFullName = "userfn userln",
			userScreenName = "usersn");

		User.logoutAndLoginPG(
			userLoginEmailAddress = "test@liferay.com",
			userLoginFullName = "Test Test");

		PermissionsInline.gotoDocumentsAndMediaHomeFolderPG(
			pageName = "Documents and Media Page",
			siteName = "Site Name",
			siteURLTemp = "true");

		Role.removePermissionPG(
			permissionDefinitionKey = "INLINE_PERMISSIONS_ADD_DOCUMENT_CHECKBOX",
			roleTitle = "Site Member");

		User.logoutAndLoginPG(
			userLoginEmailAddress = "userea@liferay.com",
			userLoginFullName = "userfn userln");

		Navigator.gotoSitePage(
			pageName = "Documents and Media Page",
			siteName = "Site Name");

		Portlet.clickPortletPlusIconPG(portletName = "Documents and Media");

		MenuItem.viewNotPresent(menuItem = "File Upload");
	}

	@priority = 4
	@refactordone
	test CanViewFolderAsGuestWithPermissions {
		property portal.acceptance = "true";

		JSONGroup.addGroup(groupName = "Site Name");

		JSONLayout.addPublicLayout(
			groupName = "Site Name",
			layoutName = "Documents and Media Page");

		JSONLayout.addWidgetToPublicLayout(
			column = 1,
			groupName = "Site Name",
			layoutName = "Documents and Media Page",
			widgetName = "Documents and Media");

		JSONFolder.addFolder(
			dmFolderDescription = "DM Folder Description",
			dmFolderName = "DM Folder Name",
			groupName = "Site Name");

		DMNavigator.openDocumentsAndMediaAdmin(siteURLKey = "site-name");

		DMNavigator.gotoFolderPermissions(dmFolderName = "DM Folder Name");

		PermissionsInline.addOrRemoveAccessPermissionFromAllRoles(
			addOrRemoveViewPermission = "Add",
			roleList = "guest");

		User.logoutPG();

		Navigator.openSitePage(
			pageName = "Documents and Media Page",
			siteName = "Site Name");

		LexiconEntry.changeDisplayStyle(displayStyle = "list");

		var key_dmFolderName = "DM Folder Name";

		AssertClick(
			locator1 = "DocumentsAndMedia#DESCRIPTIVE_LIST_FOLDER_TITLE",
			value1 = "DM Folder Name");

		var dmFolderNameUpperCase = StringUtil.upperCase("DM Folder Name");

		AssertTextEquals(
			locator1 = "DocumentsAndMedia#BREADCRUMB_FOLDER_NAME",
			value1 = ${dmFolderNameUpperCase});
	}

	@description = "This test covers LPS-93031. It ensures that the document still can be viewed after the author is deleted."
	@priority = 4
	@refactordone
	test DocumentCanStillBeViewedAfterAuthorIsDeleted {
		property portal.acceptance = "true";

		JSONUser.addUser(
			userEmailAddress = "userea@liferay.com",
			userFirstName = "userfn",
			userLastName = "userln",
			userScreenName = "usersn");

		JSONUser.setFirstPassword(
			agreeToTermsAndAnswerReminderQuery = "true",
			requireReset = "false",
			userEmailAddress = "userea@liferay.com");

		ApplicationsMenu.gotoPortlet(
			category = "Users",
			panel = "Control Panel",
			portlet = "Users and Organizations");

		User.assignRegularRoleCP(
			roleTitle = "Administrator",
			userScreenName = "usersn");

		User.logoutAndLoginPG(
			userLoginEmailAddress = "userea@liferay.com",
			userLoginFullName = "userfn userln");

		JSONDocument.addFileWithUploadedFile(
			dmDocumentDescription = "DM Document Description",
			dmDocumentTitle = "DM Document Title",
			groupName = "Guest",
			mimeType = "image/jpeg",
			sourceFileName = "Document_1.jpg");

		User.logoutAndLoginPG(
			userLoginEmailAddress = "test@liferay.com",
			userLoginFullName = "Test Test");

		ApplicationsMenu.gotoPortlet(
			category = "Users",
			panel = "Control Panel",
			portlet = "Users and Organizations");

		User.deactivateCP(userFirstName = "userfn");

		User.deleteCP();

		DMNavigator.openDocumentsAndMediaAdmin(siteURLKey = "guest");

		DMNavigator.gotoDocumentCP(dmDocumentTitle = "DM Document Title");

		DMDocument.viewCP(
			dmDocumentFileName = "Document_1.jpg",
			dmDocumentTitle = "DM Document Title");
	}

	@description = "This test covers LPS-100096. It ensures that a document type cannot be edited without permissions."
	@priority = 4
	@refactordone
	test EntryCanNotBeEditedWithoutPermissions {
		property portal.acceptance = "true";

		JSONUser.addUser(
			userEmailAddress = "userea@liferay.com",
			userFirstName = "Userfn",
			userLastName = "Userln",
			userScreenName = "usersn");

		JSONUser.setFirstPassword(
			agreeToTermsAndAnswerReminderQuery = "true",
			requireReset = "false",
			userEmailAddress = "userea@liferay.com");

		JSONRole.addRegularRole(roleTitle = "Depot Regrole Name");

		JSONRole.assignRoleToUser(
			roleTitle = "Depot Regrole Name",
			userEmailAddress = "userea@liferay.com");

		Permissions.definePermissionViaJSONAPI(
			resourceAction = "VIEW_CONTROL_PANEL",
			resourceName = 90,
			roleTitle = "Depot Regrole Name");

		Permissions.definePermissionViaJSONAPI(
			resourceAction = "ACCESS_IN_CONTROL_PANEL",
			resourceName = "com_liferay_document_library_web_portlet_DLAdminPortlet",
			roleTitle = "Depot Regrole Name");

		DMNavigator.openDocumentTypesAdmin(siteURLKey = "guest");

		DMDocumentType.add(
			dmDocumentTypeDescription = "DM Document Type Description",
			dmDocumentTypeFieldNames = "Text",
			dmDocumentTypeName = "DM Document Type Name");

		LexiconEntry.gotoEntryMenuItem(
			menuItem = "Edit",
			rowEntry = "DM Document Type Name");

		WaitForSPARefresh();

		var documentTypeURL = selenium.getLocation();

		User.logoutAndLoginPG(
			userLoginEmailAddress = "userea@liferay.com",
			userLoginFullName = "userfn userln");

		DMNavigator.openDocumentTypesAdmin(siteURLKey = "guest");

		LexiconEntry.viewNoEntryMenu(rowEntry = "DM Document Type Name");

		Navigator.openSpecificURL(url = ${documentTypeURL});

		AssertTextEquals.assertPartialText(
			locator1 = "Message#ERROR",
			value1 = "You do not have the required permissions.");
	}

	@description = "This is a test for LPS-136852. It checks that a guest cannot access a folder image without permissions."
	@priority = 4
	test GuestCannotAccessFolderImageThroughURLWithoutPermissions {
		property portal.upstream = "true";

		JSONFolder.addFolder(
			dmFolderDescription = "DM Folder Description",
			dmFolderName = "DM Folder Name",
			groupName = "Guest",
			guestPermissions = "false");

		JSONDocument.addFileWithUploadedFile(
			dmDocumentDescription = "DM Document Description",
			dmDocumentTitle = "DM Document Title",
			folderName = "DM Folder Name",
			groupName = "Guest",
			mimeType = "image/jpeg",
			sourceFileName = "Document_1.jpg");

		var dmDocumentURL = DMDocument.getDMLatestVersionURL(
			dmDocumentTitle = "DM Document Title",
			dmFolderName = "DM Folder Name",
			siteURLKey = "guest");

		User.logoutPG();

		Navigator.openSpecificURL(url = ${dmDocumentURL});

		User.viewLoginPG();
	}

	@description = "This is a test for LPS-136833. It checks that a guest cannot add a document in a folder without permissions."
	@priority = 3
	test GuestCannotAddDocumentInFolder {
		JSONLayout.addPublicLayout(
			groupName = "Guest",
			layoutName = "Documents and Media Page");

		JSONLayout.addWidgetToPublicLayout(
			column = 1,
			groupName = "Guest",
			layoutName = "Documents and Media Page",
			widgetName = "Documents and Media");

		JSONFolder.addFolder(
			dmFolderDescription = "DM Folder Description",
			dmFolderName = "DM Folder Name",
			groupName = "Guest");

		Navigator.gotoPage(pageName = "Documents and Media Page");

		DMDocument.enableActionsMenuOnPortlet();

		User.logoutPG();

		Navigator.gotoPage(pageName = "Documents and Media Page");

		DMNavigator.gotoFolder(dmFolderName = "DM Folder Name");

		DMDocument.viewNoAddPermission();
	}

	@description = "This is a test for LPS-136834. It checks that a guest cannot delete a file without permissions."
	@priority = 3
	test GuestCannotDeleteFile {
		JSONLayout.addPublicLayout(
			groupName = "Guest",
			layoutName = "Documents and Media Page");

		JSONLayout.addWidgetToPublicLayout(
			column = 1,
			groupName = "Guest",
			layoutName = "Documents and Media Page",
			widgetName = "Documents and Media");

		JSONDocument.addFileWithUploadedFile(
			dmDocumentDescription = "DM Document Description",
			dmDocumentTitle = "DM Document Title",
			groupName = "Guest",
			mimeType = "text/plain",
			sourceFileName = "Document_1.txt");

		Navigator.gotoPage(pageName = "Documents and Media Page");

		DMDocument.enableActionsMenuOnPortlet();

		User.logoutPG();

		Navigator.gotoPage(pageName = "Documents and Media Page");

		LexiconCard.viewMenuItemNotPresent(
			card = "DM Document Title",
			item = "Delete");

		LexiconCard.checkCardCheckbox(card = "DM Document Title");

		ManagementBar.viewNoItems(textList = "trash");
	}

	@description = "This is a test for LPS-136835. It checks that a guest cannot subscribe to a folder without permissions."
	@priority = 3
	test GuestCannotSubscribeToFolder {
		JSONLayout.addPublicLayout(
			groupName = "Guest",
			layoutName = "Documents and Media Page");

		JSONLayout.addWidgetToPublicLayout(
			column = 1,
			groupName = "Guest",
			layoutName = "Documents and Media Page",
			widgetName = "Documents and Media");

		JSONFolder.addFolder(
			dmFolderDescription = "DM Folder Description",
			dmFolderName = "DM Folder Name",
			groupName = "Guest");

		User.logoutPG();

		Navigator.gotoPage(pageName = "Documents and Media Page");

		DMNavigator.gotoFolder(dmFolderName = "DM Folder Name");

		DMFolder.viewNoSubscribe();
	}

	@description = "This is a test for LPS-136836. It checks that a guest cannot update comments in a file without permissions."
	@priority = 3
	test GuestCannotUpdateComments {
		property testray.component.names = "Comment";

		JSONLayout.addPublicLayout(
			groupName = "Guest",
			layoutName = "Documents and Media Page");

		JSONLayout.addWidgetToPublicLayout(
			column = 1,
			groupName = "Guest",
			layoutName = "Documents and Media Page",
			widgetName = "Documents and Media");

		JSONDocument.addFileWithUploadedFile(
			dmDocumentDescription = "DM Document Description",
			dmDocumentTitle = "DM Document Title",
			groupName = "Guest",
			mimeType = "text/plain",
			sourceFileName = "Document_1.txt");

		JSONDocument.addComment(
			commentBody = "DM Document Comment",
			dmDocumentTitle = "DM Document Title",
			groupName = "Guest");

		User.logoutPG();

		Navigator.gotoPage(pageName = "Documents and Media Page");

		DMNavigator.gotoDocumentPG(dmDocumentTitle = "DM Document Title");

		Comments.viewNoActions(entryComment = "DM Document Comment");
	}

	@description = "This is a test for LPS-136837. It checks that a guest cannot update a folder without permissions."
	@priority = 3
	test GuestCannotUpdateFolder {
		JSONLayout.addPublicLayout(
			groupName = "Guest",
			layoutName = "Documents and Media Page");

		JSONLayout.addWidgetToPublicLayout(
			column = 1,
			groupName = "Guest",
			layoutName = "Documents and Media Page",
			widgetName = "Documents and Media");

		Navigator.gotoPage(pageName = "Documents and Media Page");

		DMDocument.enableActionsMenuOnPortlet();

		JSONFolder.addFolder(
			dmFolderDescription = "DM Folder Description",
			dmFolderName = "DM Folder Name",
			groupName = "Guest");

		User.logoutPG();

		Navigator.gotoPage(pageName = "Documents and Media Page");

		LexiconCard.viewMenuItemNotPresent(
			card = "DM Folder Name",
			item = "Edit");

		DMNavigator.gotoFolder(dmFolderName = "DM Folder Name");

		DMDocument.gotoMenuItemViaInfoPanel();

		MenuItem.viewNotPresent(menuItem = "Edit");
	}

	@description = "This is a test for LPS-136838. It checks that a guest cannot view a folder without permissions."
	@priority = 3
	test GuestCannotViewFolder {
		JSONGroup.addGroup(groupName = "Site Name");

		JSONLayout.addPublicLayout(
			groupName = "Site Name",
			layoutName = "Documents and Media Page");

		JSONLayout.addWidgetToPublicLayout(
			column = 1,
			groupName = "Site Name",
			layoutName = "Documents and Media Page",
			widgetName = "Documents and Media");

		JSONFolder.addFolder(
			dmFolderDescription = "DM Folder Description",
			dmFolderName = "DM Folder Name",
			groupName = "Site Name",
			guestPermissions = "false");

		User.logoutPG();

		Navigator.openSitePage(
			pageName = "Documents and Media Page",
			siteName = "Site Name");

		DMPortlet.viewDefaultPG();
	}

	@description = "This is a test for LPS-136832. It checks that a guest can access an image in a folder through the URL when he has permissions."
	@priority = 3
	test GuestWithAccessToFolderCanAccessImageThroughURL {
		JSONGroup.addGroup(groupName = "Site Name");

		JSONLayout.addPublicLayout(
			groupName = "Site Name",
			layoutName = "Documents and Media Page");

		JSONLayout.addWidgetToPublicLayout(
			column = 1,
			groupName = "Site Name",
			layoutName = "Documents and Media Page",
			widgetName = "Documents and Media");

		JSONFolder.addFolder(
			dmFolderDescription = "DM Folder Description",
			dmFolderName = "DM Folder Name",
			groupName = "Site Name",
			guestPermissions = "false");

		JSONDocument.addFileWithUploadedFile(
			dmDocumentDescription = "DM Document Description",
			dmDocumentTitle = "DM Document Title",
			folderName = "DM Folder Name",
			groupName = "Site Name",
			mimeType = "image/jpeg",
			sourceFileName = "Document_1.jpg");

		Navigator.openSitePage(
			pageName = "Documents and Media Page",
			siteName = "Site Name");

		DMDocument.enableActionsMenuOnPortlet();

		Navigator.openSitePage(
			pageName = "Documents and Media Page",
			siteName = "Site Name");

		PermissionsInline.gotoDocumentsAndMediaDocumentPG(dmDocumentTitle = "DM Folder Name");

		Role.definePermissionPG(
			permissionDefinitionKey = "CONTENT_PERMISSIONS_ACCESS_CHECKBOX",
			roleTitle = "Guest");

		var dmDocumentURL = DMDocument.getDMLatestVersionURL(
			dmDocumentTitle = "DM Document Title",
			dmFolderName = "DM Folder Name",
			siteURLKey = "Site Name");

		User.logoutPG();

		Navigator.openSitePage(
			pageName = "Documents and Media Page",
			siteName = "Site Name");

		DMDocument.viewDefault();

		Navigator.openSpecificURL(url = ${dmDocumentURL});

		AssertVisible(
			key_imageSourceURL = "dm-document-title",
			locator1 = "DocumentsAndMediaDocument#DOCUMENT_VIEWPORT_PREVIEW");
	}

	@description = "This test covers LPS-106905. It ensures that a site admin user is able to select an image from the global site in WCD."
	@priority = 3
	@refactordone
	test ImageFromGlobalSiteCanBeSelectedWithPermissionsInWCD {
		DMNavigator.openDocumentsAndMediaAdmin(siteURLKey = "global");

		DMDocument.addCP(
			dmDocumentDescription = "DM Document Description",
			dmDocumentFile = "Document_1.png",
			dmDocumentTitle = "Document_1.png");

		JSONGroup.addGroup(groupName = "Site Name");

		JSONLayout.addPublicLayout(
			groupName = "Site Name",
			layoutName = "Test Page");

		JSONLayout.addWidgetToPublicLayout(
			groupName = "Site Name",
			layoutName = "Test Page",
			widgetName = "Web Content Display");

		JSONUser.addUser(
			userEmailAddress = "userea@liferay.com",
			userFirstName = "userfn",
			userLastName = "userln",
			userScreenName = "usersn");

		JSONUser.setFirstPassword(
			agreeToTermsAndAnswerReminderQuery = "true",
			requireReset = "false",
			userEmailAddress = "userea@liferay.com");

		JSONUser.addUserToSite(
			groupName = "Site Name",
			userEmailAddress = "userea@liferay.com");

		JSONRole.assignSiteRoleToUser(
			groupName = "Site Name",
			roleTitle = "Site Administrator",
			userEmailAddress = "userea@liferay.com");

		User.logoutAndLoginPG(
			userLoginEmailAddress = "userea@liferay.com",
			userLoginFullName = "userfn userln");

		Navigator.gotoSitePage(
			pageName = "Test Page",
			siteName = "Site Name");

		WebContentDisplayPortlet.add(
			embedImage = "true",
			imageFileName = "Document_1.png",
			siteName = "Global",
			webContentContent = "WC WebContent Content",
			webContentTitle = "WC WebContent Title");

		WebContentDisplayPortlet.viewContent(
			imageFileName = "document_1",
			webContentTitle = "WC WebContent Title");
	}

	@priority = 5
	@refactordone
	test RegRoleCannotAddDocumentByDefault {
		property portal.acceptance = "true";

		Permissions.setUpRegRolePG(
			pageName = "Documents and Media Page",
			portletName = "Documents and Media",
			roleTitle = "Regrole Name",
			userEmailAddress = "userea@liferay.com",
			userFirstName = "userfn",
			userLastName = "userln",
			userScreenName = "usersn");

		User.logoutAndLoginPG(
			userLoginEmailAddress = "userea@liferay.com",
			userLoginFullName = "userfn userln");

		Navigator.gotoPage(pageName = "Documents and Media Page");

		AssertElementNotPresent(locator1 = "Toolbar#ADD");
	}

	@description = "This is a test for LPS-136852. It checks that a site member cannot access a folder image without permissions."
	@priority = 3
	test SiteMemberCannotAccessFolderImageThroughURLWithoutPermissions {
		JSONUser.addUser(
			userEmailAddress = "userea@liferay.com",
			userFirstName = "userfn",
			userLastName = "userln",
			userScreenName = "usersn");

		JSONUser.setFirstPassword(
			agreeToTermsAndAnswerReminderQuery = "true",
			requireReset = "false",
			userEmailAddress = "userea@liferay.com");

		JSONUser.addUserToSite(
			groupName = "Guest",
			userEmailAddress = "userea@liferay.com");

		JSONFolder.addFolder(
			dmFolderDescription = "DM Folder Description",
			dmFolderName = "DM Folder Name",
			groupName = "Guest",
			groupPermissions = "false",
			guestPermissions = "false");

		JSONDocument.addFileWithUploadedFile(
			dmDocumentDescription = "DM Document Description",
			dmDocumentTitle = "DM Document Title",
			folderName = "DM Folder Name",
			groupName = "Guest",
			mimeType = "image/jpeg",
			sourceFileName = "Document_1.jpg");

		var dmDocumentURL = DMDocument.getDMLatestVersionURL(
			dmDocumentTitle = "DM Document Title",
			dmFolderName = "DM Folder Name",
			siteURLKey = "guest");

		User.logoutAndLoginPG(
			userLoginEmailAddress = "userea@liferay.com",
			userLoginFullName = "userfn userln");

		Navigator.openSpecificURL(url = ${dmDocumentURL});

		AssertTextPresent(value1 = "You do not have permission to access the requested resource.");
	}

	@description = "This is a test for LPS-136841. It checks that a site member cannot add a document in a folder without permissions."
	@priority = 3
	test SiteMemberCannotAddDocumentInFolder {
		JSONUser.addUser(
			userEmailAddress = "userea@liferay.com",
			userFirstName = "userfn",
			userLastName = "userln",
			userScreenName = "usersn");

		JSONUser.setFirstPassword(
			agreeToTermsAndAnswerReminderQuery = "true",
			requireReset = "false",
			userEmailAddress = "userea@liferay.com");

		JSONUser.addUserToSite(
			groupName = "Guest",
			userEmailAddress = "userea@liferay.com");

		JSONLayout.addPublicLayout(
			groupName = "Guest",
			layoutName = "Documents and Media Page");

		JSONLayout.addWidgetToPublicLayout(
			column = 1,
			groupName = "Guest",
			layoutName = "Documents and Media Page",
			widgetName = "Documents and Media");

		JSONFolder.addFolder(
			dmFolderDescription = "DM Folder Description",
			dmFolderName = "DM Folder Name",
			groupName = "Guest");

		Navigator.gotoPage(pageName = "Documents and Media Page");

		DMDocument.enableActionsMenuOnPortlet();

		Navigator.gotoPage(pageName = "Documents and Media Page");

		PermissionsInline.gotoDocumentsAndMediaDocumentPG(dmDocumentTitle = "DM Folder Name");

		Role.removePermissionPG(
			permissionDefinitionKey = "INLINE_PERMISSIONS_ADD_DOCUMENT_CHECKBOX",
			roleTitle = "Site Member");

		User.logoutAndLoginPG(
			userLoginEmailAddress = "userea@liferay.com",
			userLoginFullName = "userfn userln");

		Navigator.gotoPage(pageName = "Documents and Media Page");

		DMNavigator.gotoFolder(dmFolderName = "DM Folder Name");

		LexiconEntry.gotoAdd();

		for (var menuItem : list "File Upload,Multiple Files Upload") {
			MenuItem.viewNotPresent(menuItem = ${menuItem});
		}
	}

	@description = "This is a test for LPS-136842. It checks that a site member cannot add a shortcut without permissions."
	@priority = 3
	test SiteMemberCannotAddShortcut {
		JSONUser.addUser(
			userEmailAddress = "userea@liferay.com",
			userFirstName = "userfn",
			userLastName = "userln",
			userScreenName = "usersn");

		JSONUser.setFirstPassword(
			agreeToTermsAndAnswerReminderQuery = "true",
			requireReset = "false",
			userEmailAddress = "userea@liferay.com");

		JSONUser.addUserToSite(
			groupName = "Guest",
			userEmailAddress = "userea@liferay.com");

		JSONLayout.addPublicLayout(
			groupName = "Guest",
			layoutName = "Documents and Media Page");

		JSONLayout.addWidgetToPublicLayout(
			column = 1,
			groupName = "Guest",
			layoutName = "Documents and Media Page",
			widgetName = "Documents and Media");

		JSONDocument.addFileWithUploadedFile(
			dmDocumentDescription = "DM Document Description",
			dmDocumentTitle = "DM Document Title",
			groupName = "Guest",
			mimeType = "text/plain",
			sourceFileName = "Document_1.txt");

		Navigator.gotoPage(pageName = "Documents and Media Page");

		DMDocument.enableActionsMenuOnPortlet();

		Navigator.gotoPage(pageName = "Documents and Media Page");

		DMDocument.gotoMenuItemViaInfoPanel(menuItem = "Permissions");

		Role.removePermissionPG(
			permissionDefinitionKey = "INLINE_PERMISSIONS_ADD_SHORTCUT_CHECKBOX",
			roleTitle = "Site Member");

		User.logoutAndLoginPG(
			userLoginEmailAddress = "userea@liferay.com",
			userLoginFullName = "userfn userln");

		Navigator.gotoPage(pageName = "Documents and Media Page");

		LexiconEntry.gotoAdd();

		MenuItem.viewNotPresent(menuItem = "Shortcut");
	}

	@description = "This is a test for LPS-136845. It checks that a site member cannot delete a file without permissions."
	@priority = 3
	test SiteMemberCannotDeleteFile {
		JSONUser.addUser(
			userEmailAddress = "userea@liferay.com",
			userFirstName = "userfn",
			userLastName = "userln",
			userScreenName = "usersn");

		JSONUser.setFirstPassword(
			agreeToTermsAndAnswerReminderQuery = "true",
			requireReset = "false",
			userEmailAddress = "userea@liferay.com");

		JSONUser.addUserToSite(
			groupName = "Guest",
			userEmailAddress = "userea@liferay.com");

		JSONLayout.addPublicLayout(
			groupName = "Guest",
			layoutName = "Documents and Media Page");

		JSONLayout.addWidgetToPublicLayout(
			column = 1,
			groupName = "Guest",
			layoutName = "Documents and Media Page",
			widgetName = "Documents and Media");

		JSONDocument.addFileWithUploadedFile(
			dmDocumentDescription = "DM Document Description",
			dmDocumentTitle = "DM Document Title",
			groupName = "Guest",
			mimeType = "text/plain",
			sourceFileName = "Document_1.txt");

		Navigator.gotoPage(pageName = "Documents and Media Page");

		DMDocument.enableActionsMenuOnPortlet();

		User.logoutAndLoginPG(
			userLoginEmailAddress = "userea@liferay.com",
			userLoginFullName = "userfn userln");

		Navigator.gotoPage(pageName = "Documents and Media Page");

		LexiconCard.viewMenuItemNotPresent(
			card = "DM Document Title",
			item = "Delete");

		LexiconCard.checkCardCheckbox(card = "DM Document Title");

		ManagementBar.viewItemsDisabled(textList = "trash");
	}

	@description = "This is a test for LPS-136846. It checks that a site member cannot delete a shortcut without permissions."
	@priority = 3
	test SiteMemberCannotDeleteShortcut {
		JSONGroup.addGroup(groupName = "Site Name");

		JSONUser.addUser(
			userEmailAddress = "userea@liferay.com",
			userFirstName = "userfn",
			userLastName = "userln",
			userScreenName = "usersn");

		JSONUser.setFirstPassword(
			agreeToTermsAndAnswerReminderQuery = "true",
			requireReset = "false",
			userEmailAddress = "userea@liferay.com");

		JSONUser.addUserToSite(
			groupName = "Guest",
			userEmailAddress = "userea@liferay.com");

		JSONLayout.addPublicLayout(
			groupName = "Guest",
			layoutName = "Documents and Media Page");

		JSONLayout.addWidgetToPublicLayout(
			column = 1,
			groupName = "Guest",
			layoutName = "Documents and Media Page",
			widgetName = "Documents and Media");

		JSONDocument.addFileWithUploadedFile(
			dmDocumentDescription = "DM Document Description",
			dmDocumentTitle = "DM Document Title",
			groupName = "Site Name",
			mimeType = "text/plain",
			sourceFileName = "Document_1.txt");

		Navigator.gotoPage(pageName = "Documents and Media Page");

		DMDocument.enableActionsMenuOnPortlet();

		DMDocument.addDMShortcutPG(
			dmDocumentTitle = "DM Document Title",
			siteName = "Site Name");

		User.logoutAndLoginPG(
			userLoginEmailAddress = "userea@liferay.com",
			userLoginFullName = "userfn userln");

		Navigator.gotoPage(pageName = "Documents and Media Page");

		LexiconCard.viewMenuItemNotPresent(
			card = "DM Document Title",
			item = "Delete");

		LexiconCard.checkCardCheckbox(card = "DM Document Title");

		ManagementBar.viewItemsDisabled(textList = "trash");
	}

	@description = "This is a test for LPS-136847. It checks that a site member cannot override a checkout process without permissions."
	@priority = 3
	test SiteMemberCannotOverrideCheckout {
		JSONUser.addUser(
			userEmailAddress = "userea@liferay.com",
			userFirstName = "userfn",
			userLastName = "userln",
			userScreenName = "usersn");

		JSONUser.setFirstPassword(
			agreeToTermsAndAnswerReminderQuery = "true",
			requireReset = "false",
			userEmailAddress = "userea@liferay.com");

		JSONUser.addUserToSite(
			groupName = "Guest",
			userEmailAddress = "userea@liferay.com");

		JSONLayout.addPublicLayout(
			groupName = "Guest",
			layoutName = "Documents and Media Page");

		JSONLayout.addWidgetToPublicLayout(
			column = 1,
			groupName = "Guest",
			layoutName = "Documents and Media Page",
			widgetName = "Documents and Media");

		JSONDocument.addFileWithUploadedFile(
			dmDocumentDescription = "DM Document Description",
			dmDocumentTitle = "DM Document Title",
			groupName = "Guest",
			mimeType = "text/plain",
			sourceFileName = "Document_1.txt");

		Navigator.gotoPage(pageName = "Documents and Media Page");

		DMDocument.enableActionsMenuOnPortlet();

		Navigator.gotoPage(pageName = "Documents and Media Page");

		DMDocument.checkoutPG(dmDocumentTitle = "DM Document Title");

		User.logoutAndLoginPG(
			userLoginEmailAddress = "userea@liferay.com",
			userLoginFullName = "userfn userln");

		Navigator.gotoPage(pageName = "Documents and Media Page");

		LexiconCard.viewMenuItemNotPresent(
			card = "DM Document Title",
			item = "Cancel Checkout");

		DMNavigator.gotoDocumentPG(dmDocumentTitle = "DM Document Title");

		DMDocument.gotoMenuItemViaInfoPanel();

		MenuItem.viewNotPresent(menuItem = "Cancel Checkout");
	}

	@description = "This is a test for LPS-136848. It checks that a site member cannot subscribe to a folder without permissions."
	@priority = 3
	test SiteMemberCannotSubscribeToFolder {
		JSONUser.addUser(
			userEmailAddress = "userea@liferay.com",
			userFirstName = "userfn",
			userLastName = "userln",
			userScreenName = "usersn");

		JSONUser.setFirstPassword(
			agreeToTermsAndAnswerReminderQuery = "true",
			requireReset = "false",
			userEmailAddress = "userea@liferay.com");

		JSONUser.addUserToSite(
			groupName = "Guest",
			userEmailAddress = "userea@liferay.com");

		JSONLayout.addPublicLayout(
			groupName = "Guest",
			layoutName = "Documents and Media Page");

		JSONLayout.addWidgetToPublicLayout(
			column = 1,
			groupName = "Guest",
			layoutName = "Documents and Media Page",
			widgetName = "Documents and Media");

		JSONFolder.addFolder(
			dmFolderDescription = "DM Folder Description",
			dmFolderName = "DM Folder Name",
			groupName = "Guest");

		DMNavigator.openDocumentsAndMediaAdmin(siteURLKey = "guest");

		DMNavigator.gotoFolderPermissions(dmFolderName = "DM Folder Name");

		Role.removePermissionPG(
			permissionDefinitionKey = "INLINE_PERMISSIONS_SUBSCRIBE_CHECKBOX",
			roleTitle = "Site Member");

		User.logoutAndLoginPG(
			userLoginEmailAddress = "userea@liferay.com",
			userLoginFullName = "userfn userln");

		Navigator.gotoPage(pageName = "Documents and Media Page");

		DMNavigator.gotoFolder(dmFolderName = "DM Folder Name");

		DMFolder.viewNoSubscribe();
	}

	@description = "This is a test for LPS-136849. It checks that a site member cannot update comments without permissions."
	@priority = 3
	test SiteMemberCannotUpdateComments {
		property testray.component.names = "Comment";

		JSONUser.addUser(
			userEmailAddress = "userea@liferay.com",
			userFirstName = "userfn",
			userLastName = "userln",
			userScreenName = "usersn");

		JSONUser.setFirstPassword(
			agreeToTermsAndAnswerReminderQuery = "true",
			requireReset = "false",
			userEmailAddress = "userea@liferay.com");

		JSONUser.addUserToSite(
			groupName = "Guest",
			userEmailAddress = "userea@liferay.com");

		JSONLayout.addPublicLayout(
			groupName = "Guest",
			layoutName = "Documents and Media Page");

		JSONLayout.addWidgetToPublicLayout(
			column = 1,
			groupName = "Guest",
			layoutName = "Documents and Media Page",
			widgetName = "Documents and Media");

		JSONDocument.addFileWithUploadedFile(
			dmDocumentDescription = "DM Document Description",
			dmDocumentTitle = "DM Document Title",
			groupName = "Guest",
			mimeType = "text/plain",
			sourceFileName = "Document_1.txt");

		JSONDocument.addComment(
			commentBody = "DM Document Comment",
			dmDocumentTitle = "DM Document Title",
			groupName = "Guest");

		User.logoutAndLoginPG(
			userLoginEmailAddress = "userea@liferay.com",
			userLoginFullName = "userfn userln");

		Navigator.gotoPage(pageName = "Documents and Media Page");

		DMNavigator.gotoDocumentPG(dmDocumentTitle = "DM Document Title");

		Comments.viewNoActions(entryComment = "DM Document Comment");
	}

	@description = "This is a test for LPS-136843. It checks that a site member cannot update the permissions of a file without permissions."
	@priority = 3
	test SiteMemberCannotUpdateFilePermissions {
		JSONUser.addUser(
			userEmailAddress = "userea@liferay.com",
			userFirstName = "userfn",
			userLastName = "userln",
			userScreenName = "usersn");

		JSONUser.setFirstPassword(
			agreeToTermsAndAnswerReminderQuery = "true",
			requireReset = "false",
			userEmailAddress = "userea@liferay.com");

		JSONUser.addUserToSite(
			groupName = "Guest",
			userEmailAddress = "userea@liferay.com");

		JSONLayout.addPublicLayout(
			groupName = "Guest",
			layoutName = "Documents and Media Page");

		JSONLayout.addWidgetToPublicLayout(
			column = 1,
			groupName = "Guest",
			layoutName = "Documents and Media Page",
			widgetName = "Documents and Media");

		JSONDocument.addFileWithUploadedFile(
			dmDocumentDescription = "DM Document Description",
			dmDocumentTitle = "DM Document Title",
			groupName = "Guest",
			mimeType = "text/plain",
			sourceFileName = "Document_1.txt");

		Navigator.gotoPage(pageName = "Documents and Media Page");

		DMDocument.enableActionsMenuOnPortlet();

		User.logoutAndLoginPG(
			userLoginEmailAddress = "userea@liferay.com",
			userLoginFullName = "userfn userln");

		Navigator.gotoPage(pageName = "Documents and Media Page");

		LexiconCard.viewMenuItemNotPresent(
			card = "DM Document Title",
			item = "Permissions");

		Navigator.gotoPage(pageName = "Documents and Media Page");

		DMDocument.gotoEntry(dmDocumentTitle = "DM Document Title");

		AssertElementNotPresent(locator1 = "Button#PERMISSIONS");
	}

	@description = "This is a test for LPS-136850. It checks that a site member cannot update a folder without permissions."
	@priority = 3
	test SiteMemberCannotUpdateFolder {
		JSONUser.addUser(
			userEmailAddress = "userea@liferay.com",
			userFirstName = "userfn",
			userLastName = "userln",
			userScreenName = "usersn");

		JSONUser.setFirstPassword(
			agreeToTermsAndAnswerReminderQuery = "true",
			requireReset = "false",
			userEmailAddress = "userea@liferay.com");

		JSONUser.addUserToSite(
			groupName = "Guest",
			userEmailAddress = "userea@liferay.com");

		JSONLayout.addPublicLayout(
			groupName = "Guest",
			layoutName = "Documents and Media Page");

		JSONLayout.addWidgetToPublicLayout(
			column = 1,
			groupName = "Guest",
			layoutName = "Documents and Media Page",
			widgetName = "Documents and Media");

		JSONFolder.addFolder(
			dmFolderDescription = "DM Folder Description",
			dmFolderName = "DM Folder Name",
			groupName = "Guest");

		Navigator.gotoPage(pageName = "Documents and Media Page");

		DMDocument.enableActionsMenuOnPortlet();

		User.logoutAndLoginPG(
			userLoginEmailAddress = "userea@liferay.com",
			userLoginFullName = "userfn userln");

		Navigator.gotoPage(pageName = "Documents and Media Page");

		LexiconCard.viewMenuItemNotPresent(
			card = "DM Folder Name",
			item = "Edit");

		DMNavigator.gotoFolder(dmFolderName = "DM Folder Name");

		DMDocument.gotoMenuItemViaInfoPanel();

		MenuItem.viewNotPresent(menuItem = "Edit");
	}

	@description = "This is a test for LPS-136844. It checks that a site member cannot update the permissions of a folder without permissions."
	@priority = 3
	test SiteMemberCannotUpdateFolderPermissions {
		JSONUser.addUser(
			userEmailAddress = "userea@liferay.com",
			userFirstName = "userfn",
			userLastName = "userln",
			userScreenName = "usersn");

		JSONUser.setFirstPassword(
			agreeToTermsAndAnswerReminderQuery = "true",
			requireReset = "false",
			userEmailAddress = "userea@liferay.com");

		JSONUser.addUserToSite(
			groupName = "Guest",
			userEmailAddress = "userea@liferay.com");

		JSONLayout.addPublicLayout(
			groupName = "Guest",
			layoutName = "Documents and Media Page");

		JSONLayout.addWidgetToPublicLayout(
			column = 1,
			groupName = "Guest",
			layoutName = "Documents and Media Page",
			widgetName = "Documents and Media");

		JSONFolder.addFolder(
			dmFolderDescription = "DM Folder Description",
			dmFolderName = "DM Folder Name",
			groupName = "Guest");

		Navigator.gotoPage(pageName = "Documents and Media Page");

		DMDocument.enableActionsMenuOnPortlet();

		User.logoutAndLoginPG(
			userLoginEmailAddress = "userea@liferay.com",
			userLoginFullName = "userfn userln");

		Navigator.gotoPage(pageName = "Documents and Media Page");

		LexiconCard.viewMenuItemNotPresent(
			card = "DM Folder Name",
			item = "Permissions");

		Navigator.gotoPage(pageName = "Documents and Media Page");

		DMNavigator.gotoFolder(dmFolderName = "DM Folder Name");

		DMDocument.gotoMenuItemViaInfoPanel();

		MenuItem.viewNotPresent(menuItem = "Permissions");
	}

	@description = "This is a test for LPS-136851. It checks that a site member cannot view a file without permissions."
	@priority = 3
	test SiteMemberCannotViewFile {
		JSONGroup.addGroup(groupName = "Site Name");

		JSONUser.addUser(
			userEmailAddress = "userea@liferay.com",
			userFirstName = "userfn",
			userLastName = "userln",
			userScreenName = "usersn");

		JSONUser.setFirstPassword(
			agreeToTermsAndAnswerReminderQuery = "true",
			requireReset = "false",
			userEmailAddress = "userea@liferay.com");

		JSONUser.addUserToSite(
			groupName = "Site Name",
			userEmailAddress = "userea@liferay.com");

		JSONLayout.addPublicLayout(
			groupName = "Site Name",
			layoutName = "Documents and Media Page");

		JSONLayout.addWidgetToPublicLayout(
			column = 1,
			groupName = "Site Name",
			layoutName = "Documents and Media Page",
			widgetName = "Documents and Media");

		JSONDocument.addFileWithUploadedFile(
			dmDocumentDescription = "DM Document Description",
			dmDocumentTitle = "DM Document Title",
			groupName = "Site Name",
			groupPermissions = "false",
			guestPermissions = "false",
			mimeType = "text/plain",
			sourceFileName = "Document_1.txt");

		Navigator.openSitePage(
			pageName = "Documents and Media Page",
			siteName = "Site Name");

		User.logoutAndLoginPG(
			userLoginEmailAddress = "userea@liferay.com",
			userLoginFullName = "userfn userln");

		Navigator.openSitePage(
			pageName = "Documents and Media Page",
			siteName = "Site Name");

		DMPortlet.viewDefaultPG();
	}

	@description = "This is a test for LPS-136840. It checks that a site member can access an image in a folder through the URL with permissions."
	@priority = 3
	test SiteMemberWithAccessToFolderCanAccessImageThroughURL {
		JSONGroup.addGroup(groupName = "Site Name");

		JSONUser.addUser(
			userEmailAddress = "userea@liferay.com",
			userFirstName = "userfn",
			userLastName = "userln",
			userScreenName = "usersn");

		JSONUser.setFirstPassword(
			agreeToTermsAndAnswerReminderQuery = "true",
			requireReset = "false",
			userEmailAddress = "userea@liferay.com");

		JSONUser.addUserToSite(
			groupName = "Site Name",
			userEmailAddress = "userea@liferay.com");

		JSONLayout.addPublicLayout(
			groupName = "Site Name",
			layoutName = "Documents and Media Page");

		JSONLayout.addWidgetToPublicLayout(
			column = 1,
			groupName = "Site Name",
			layoutName = "Documents and Media Page",
			widgetName = "Documents and Media");

		JSONFolder.addFolder(
			dmFolderDescription = "DM Folder Description",
			dmFolderName = "DM Folder Name",
			groupName = "Site Name",
			groupPermissions = "false",
			guestPermissions = "false");

		JSONDocument.addFileWithUploadedFile(
			dmDocumentDescription = "DM Document Description",
			dmDocumentTitle = "DM Document Title",
			folderName = "DM Folder Name",
			groupName = "Site Name",
			mimeType = "image/jpeg",
			sourceFileName = "Document_1.jpg");

		Navigator.openSitePage(
			pageName = "Documents and Media Page",
			siteName = "Site Name");

		DMDocument.enableActionsMenuOnPortlet();

		Navigator.openSitePage(
			pageName = "Documents and Media Page",
			siteName = "Site Name");

		PermissionsInline.gotoDocumentsAndMediaDocumentPG(dmDocumentTitle = "DM Folder Name");

		Role.definePermissionPG(
			permissionDefinitionKey = "CONTENT_PERMISSIONS_ACCESS_CHECKBOX",
			roleTitle = "site-member");

		var dmDocumentURL = DMDocument.getDMLatestVersionURL(
			dmDocumentTitle = "DM Document Title",
			dmFolderName = "DM Folder Name",
			siteURLKey = "Site Name");

		User.logoutAndLoginPG(
			userLoginEmailAddress = "userea@liferay.com",
			userLoginFullName = "userfn userln");

		Navigator.openSitePage(
			pageName = "Documents and Media Page",
			siteName = "Site Name");

		DMDocument.viewDefault();

		Navigator.openSpecificURL(url = ${dmDocumentURL});

		AssertVisible(
			key_imageSourceURL = "dm-document-title",
			locator1 = "DocumentsAndMediaDocument#DOCUMENT_VIEWPORT_PREVIEW");
	}

}