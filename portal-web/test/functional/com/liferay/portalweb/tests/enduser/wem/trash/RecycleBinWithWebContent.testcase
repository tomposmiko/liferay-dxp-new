@component-name = "portal-wcm"
definition {

	property portal.release = "true";
	property portal.upstream = "true";
	property testray.component.names = "Recycle Bin,Web Content Administration";
	property testray.main.component.name = "Recycle Bin";

	setUp {
		TestCase.setUpPortalInstance();

		User.firstLoginPG();

		JSONGroup.addGroup(groupName = "Test Site Name");
	}

	tearDown {
		var testPortalInstance = PropsUtil.get("test.portal.instance");

		if ("${testPortalInstance}" == "true") {
			PortalInstances.tearDownCP();
		}
		else {
			JSONGroup.deleteGroupByName(groupName = "Test Site Name");
		}
	}

	@priority = "4"
	test DeleteWebcontent {
		JSONWebcontent.addWebContent(
			content = "WC WebContent Content",
			groupName = "Test Site Name",
			title = "WC WebContent Title");

		WebContentNavigator.openWebContentAdmin(siteURLKey = "test-site-name");

		WebContent.moveToRecycleBinCP(
			assetType = "Web Content Article",
			webContentContent = "WC WebContent Content",
			webContentTitle = "WC WebContent Title");

		Navigator.openURL();

		RecycleBin.openRecycleBinAdmin(siteURLKey = "test-site-name");

		RecycleBin.deleteCP(
			assetName = "WC WebContent Title",
			assetType = "Web Content Article");

		RecycleBin.openRecycleBinAdmin(siteURLKey = "test-site-name");

		RecycleBin.viewDefaultCP(assetName = "WC WebContent Title");

		WebContentNavigator.openWebContentAdmin(siteURLKey = "test-site-name");

		WebContent.viewDefaultCP(webContentTitle = "WC WebContent Title");
	}

	@priority = "3"
	test MoveFolderWithWebContentToRecycleBin {
		JSONWebcontent.addFolder(
			folderName = "WC Folder Name",
			groupName = "Test Site Name");

		JSONWebcontent.addWebContent(
			content = "WC WebContent Content",
			folderName = "WC Folder Name",
			groupName = "Test Site Name",
			title = "WC WebContent Title");

		WebContentNavigator.openWebContentAdmin(siteURLKey = "test-site-name");

		WebContentFolder.moveToRecycleBinCP(
			assetType = "Web Content Folder",
			folderName = "WC Folder Name");

		WebContent.viewDefaultCP(webContentTitle = "WC Folder Name");

		RecycleBin.openRecycleBinAdmin(siteURLKey = "test-site-name");

		RecycleBin.viewCP(
			assetName = "WC Folder Name",
			assetType = "Web Content Folder",
			deleteUser = "Test Test");
	}

	@description = "This is a use case for LPS-123274. Can move web content to recycle bin via drag and drop."
	@priority = "3"
	test MoveWebContentToRecycleBinViaDragAndDrop {
		task ("Add a web content") {
			JSONWebcontent.addWebContent(
				content = "Web Content Content",
				groupName = "Test Site Name",
				title = "Web Content Title");
		}

		task ("Navigate to Web Content admin") {
			ApplicationsMenu.gotoSite(site = "Test Site Name");

			ProductMenu.gotoPortlet(
				category = "Content & Data",
				portlet = "Web Content");
		}

		task ("Expand the Recycle Bin category") {
			ProductMenuHelper.expandCategory(category = "Recycle Bin");
		}

		task ("Move the web content to recycle bin via drag and drop") {
			DragAndDrop.dragAndDropToObject(
				key_listEntry = "Web Content Title",
				key_portlet = "Recycle Bin",
				locator1 = "LexiconList#LIST_ENTRY",
				locator2 = "ProductMenu#PORTLET",
				value1 = "Web Content Title");

			Alert.viewSuccessMessage();
		}

		task ("Assert the web content is not shown in Web Content admin") {
			AssertElementNotPresent(
				key_webContentTitle = "Web Content Title",
				locator1 = "WC#ENTRY_LIST_TITLE");
		}

		task ("Assert the web content is shown in Recycle Bin") {
			RecycleBin.openRecycleBinAdmin(siteURLKey = "test-site-name");

			RecycleBin.viewCP(
				assetName = "Web Content Title",
				assetType = "Web Content Article",
				deleteUser = "Test Test");
		}
	}

	@priority = "3"
	test RecycleBinWebContent {
		WebContentStructures.openWebContentStructuresAdmin(siteURLKey = "test-site-name");

		WebContentStructures.addCP(
			structureDescription = "WC Structure Description",
			structureName = "WC Structure Name");

		DynamicDataMapping.addField(
			field = "Text",
			fieldFieldLabel = "Text",
			fieldName = "Text");

		WebContentStructures.saveCP(structureName = "WC Structure Name");

		WebContentTemplates.openWebContentTemplatesAdmin(siteURLKey = "test-site-name");

		WebContentTemplates.addCP(
			structureName = "WC Structure Name",
			templateDescription = "WC Template Description",
			templateFieldNames = "Text",
			templateName = "WC Template Name");

		WebContentNavigator.openWebContentAdmin(siteURLKey = "test-site-name");

		WebContentNavigator.gotoAddWithStructureCP(structureName = "WC Structure Name");

		WebContent.addWithStructureCP(
			webContentText = "WC WebContent Text",
			webContentTitle = "WC WebContent Title");

		PortletEntry.publish();

		WebContent.moveToRecycleBinCP(
			assetType = "Web Content Article",
			webContentTitle = "WC WebContent Title");

		RecycleBin.openRecycleBinAdmin(siteURLKey = "test-site-name");

		RecycleBin.viewCP(
			assetName = "WC WebContent Title",
			assetType = "Web Content Article",
			deleteUser = "Test Test");

		RecycleBin.restoreCP(
			assetName = "WC WebContent Title",
			assetRestoreLocation = "Home",
			assetType = "Web Content Article");

		WebContentNavigator.openWebContentAdmin(siteURLKey = "test-site-name");

		WebContent.viewWithStructureCP(
			webContentText = "WC WebContent Text",
			webContentTitle = "WC WebContent Title");

		WebContentStructures.openWebContentStructuresAdmin(siteURLKey = "test-site-name");

		WebContentStructures.viewCP(
			structureDescription = "WC Structure Description",
			structureName = "WC Structure Name");

		LexiconEntry.gotoEntry(rowEntry = "WC Structure Name");

		DynamicDataMapping.viewField(
			fieldFieldLabel = "Text",
			fieldName = "Text");

		WebContentTemplates.openWebContentTemplatesAdmin(siteURLKey = "test-site-name");

		WebContentTemplates.viewCP(
			structureName = "WC Structure Name",
			templateDescription = "WC Template Description",
			templateFieldNames = "Text",
			templateName = "WC Template Name");
	}

	@priority = "3"
	test RecycleWebContentViaDeleteIcon {
		JSONWebcontent.addWebContent(
			content = "WC WebContent Content",
			groupName = "Test Site Name",
			title = "WC WebContent Title");

		WebContentNavigator.openWebContentAdmin(siteURLKey = "test-site-name");

		WebContent.moveToRecycleBinViaDeleteIconCP();

		WebContentNavigator.openWebContentAdmin(siteURLKey = "test-site-name");

		WebContent.viewDefaultCP(webContentTitle = "WC WebContent Title");

		RecycleBin.openRecycleBinAdmin(siteURLKey = "test-site-name");

		RecycleBin.viewCP(
			assetName = "WC WebContent Title",
			assetType = "Web Content Article",
			deleteUser = "Test Test");
	}

	@priority = "5"
	test RestoreWebcontent {
		property portal.acceptance = "true";

		JSONWebcontent.addWebContent(
			content = "WC WebContent Content",
			groupName = "Test Site Name",
			title = "WC WebContent Title");

		WebContentNavigator.openWebContentAdmin(siteURLKey = "test-site-name");

		WebContent.moveToRecycleBinCP(
			assetType = "Web Content Article",
			webContentContent = "WC WebContent Content",
			webContentTitle = "WC WebContent Title");

		RecycleBin.openRecycleBinAdmin(siteURLKey = "test-site-name");

		RecycleBin.restoreCP(
			assetName = "WC WebContent Title",
			assetRestoreLocation = "Home",
			assetType = "Web Content Article");

		RecycleBin.viewDefaultCP(assetName = "WC WebContent Title");

		WebContentNavigator.openWebContentAdmin(siteURLKey = "test-site-name");

		WebContent.viewTitle(webContentTitle = "WC WebContent Title");

		WebContentNavigator.gotoEditCP(webContentTitle = "WC WebContent Title");

		WebContent.viewCP(
			webContentContent = "WC WebContent Content",
			webContentTitle = "WC WebContent Title");
	}

	@priority = "3"
	test RestoreWebContentFromFolderCP {
		JSONWebcontent.addFolder(
			folderName = "WC Folder Name",
			groupName = "Test Site Name");

		JSONWebcontent.addWebContent(
			content = "Web Content Content",
			folderName = "WC Folder Name",
			groupName = "Test Site Name",
			title = "Web Content Title");

		WebContentNavigator.openWebContentAdmin(siteURLKey = "test-site-name");

		WebContentFolder.moveToRecycleBinCP(
			assetType = "Web Content Folder",
			folderName = "WC Folder Name");

		RecycleBin.openRecycleBinAdmin(siteURLKey = "test-site-name");

		RecycleBin.restoreContentFromFolderCP(
			assetName = "WC Folder Name",
			assetRestoreLocation = "Home",
			assetType = "Web Content Folder",
			assetType2 = "Web Content Article",
			documentName = "Web Content Title");

		WebContentNavigator.openWebContentAdmin(siteURLKey = "test-site-name");

		WebContentNavigator.gotoEditCP(webContentTitle = "Web Content Title");

		WebContent.viewCP(
			webContentContent = "Web Content Content",
			webContentTitle = "Web Content Title");
	}

	@priority = "3"
	test RestoreWebContentWithArticleVersions {
		JSONWebcontent.addFolder(
			folderName = "WC Folder Name",
			groupName = "Test Site Name");

		JSONWebcontent.addWebContent(
			content = "Web Content Content",
			folderName = "WC Folder Name",
			groupName = "Test Site Name",
			title = "Web Content Title");

		WebContentNavigator.openWebContentAdmin(siteURLKey = "test-site-name");

		WebContentFolder.gotoCP(
			folderName = "WC Folder Name",
			webContentTitle = "WC Folder Name");

		WebContentNavigator.gotoEditCP(webContentTitle = "Web Content Title");

		WebContent.editCP(
			webContentContentEdit = "Web Content Content Edit 1",
			webContentTitle = "Web Content Title",
			webContentTitleEdit = "Web Content Title Edit 1");

		WebContentNavigator.gotoEditCP(webContentTitle = "Web Content Title Edit 1");

		WebContent.editCP(
			webContentContentEdit = "Web Content Content Edit 2",
			webContentTitle = "Web Content Title Edit 1",
			webContentTitleEdit = "Web Content Title Edit 2");

		WebContentNavigator.gotoEditCP(webContentTitle = "Web Content Title Edit 2");

		WebContent.editCP(
			webContentContentEdit = "Web Content Content Edit 3",
			webContentTitle = "Web Content Title Edit 2",
			webContentTitleEdit = "Web Content Title Edit 3");

		WebContent.expireSpecificVersionCP(
			webContentList = "Web Content Title Edit 1,Web Content Title Edit 2",
			webContentTitle = "Web Content Title Edit 3");

		WebContentNavigator.openWebContentAdmin(siteURLKey = "test-site-name");

		WebContentFolder.gotoCP(
			folderName = "WC Folder Name",
			webContentTitle = "WC Folder Name");

		WebContentNavigator.gotoEditCP(webContentTitle = "Web Content Title Edit 3");

		WebContent.editCP(
			saveAsDraft = "true",
			webContentContentEdit = "Web Content Content Edit Draft",
			webContentTitle = "Web Content Title Edit 3",
			webContentTitleEdit = "Web Content Title Edit Draft");

		WebContentNavigator.openWebContentAdmin(siteURLKey = "test-site-name");

		WebContentFolder.moveToRecycleBinCP(
			assetType = "Web Content Folder",
			folderName = "WC Folder Name");

		RecycleBin.openRecycleBinAdmin(siteURLKey = "test-site-name");

		RecycleBin.restoreCP(
			assetName = "WC Folder Name",
			assetRestoreLocation = "Home",
			assetType = "Web Content Folder");

		WebContentNavigator.openWebContentAdmin(siteURLKey = "test-site-name");

		WebContentFolder.gotoCP(
			folderName = "WC Folder Name",
			webContentTitle = "WC Folder Name");

		WebContentNavigator.gotoEntryMenuItem(
			entry = "Web Content Title Edit Draft",
			menuItem = "View History");

		WebContent.viewSpecificVersionHistoryCP(
			webContentStatus = "APPROVED",
			webContentTitle = "Web Content Title");

		WebContent.viewSpecificVersionHistoryCP(
			webContentStatus = "EXPIRED",
			webContentTitle = "Web Content Title Edit 1");

		WebContent.viewSpecificVersionHistoryCP(
			webContentStatus = "EXPIRED",
			webContentTitle = "Web Content Title Edit 2");

		WebContent.viewSpecificVersionHistoryCP(
			webContentStatus = "APPROVED",
			webContentTitle = "Web Content Title Edit 3");

		WebContent.viewSpecificVersionHistoryCP(
			webContentStatus = "DRAFT",
			webContentTitle = "Web Content Title Edit Draft");
	}

	@priority = "3"
	test UndoMoveToRecycleBin {
		JSONWebcontent.addWebContent(
			content = "WC WebContent Content",
			groupName = "Test Site Name",
			title = "WC WebContent Title");

		WebContentNavigator.openWebContentAdmin(siteURLKey = "test-site-name");

		WebContent.moveToRecycleBinCP(
			assetType = "Web Content Article",
			webContentTitle = "WC WebContent Title");

		RecycleBin.undoMoveToRecycleBin();

		WebContentNavigator.openWebContentAdmin(siteURLKey = "test-site-name");

		WebContent.viewTitle(webContentTitle = "WC WebContent Title");

		RecycleBin.openRecycleBinAdmin(siteURLKey = "test-site-name");

		RecycleBin.viewDefaultCP(assetName = "WC WebContent Title");
	}

	@priority = "3"
	test ViewDuplicateAssetNamesInRecycleBin {
		JSONWebcontent.addWebContent(
			content = "WC WebContent Content",
			groupName = "Test Site Name",
			title = "WC WebContent Title");

		WebContentNavigator.openWebContentAdmin(siteURLKey = "test-site-name");

		WebContent.moveToRecycleBinViaDeleteIconCP();

		RecycleBin.openRecycleBinAdmin(siteURLKey = "test-site-name");

		RecycleBin.viewCP(
			assetName = "WC WebContent Title",
			assetType = "Web Content Article",
			deleteUser = "Test Test");

		JSONWebcontent.addWebContent(
			content = "WC WebContent Content",
			groupName = "Test Site Name",
			title = "WC WebContent Title");

		WebContentNavigator.openWebContentAdmin(siteURLKey = "test-site-name");

		WebContent.moveToRecycleBinViaDeleteIconCP();

		RecycleBin.openRecycleBinAdmin(siteURLKey = "test-site-name");

		RecycleBin.viewDuplicateNames(assetName = "WC WebContent Title");
	}

	@priority = "4"
	test ViewDuplicateFolderNamesInRecycleBin {
		JSONWebcontent.addFolder(
			folderName = "WC Folder Name",
			groupName = "Test Site Name");

		WebContentNavigator.openWebContentAdmin(siteURLKey = "test-site-name");

		WebContentFolder.moveToRecycleBinCP(
			assetType = "Web Content Folder",
			folderName = "WC Folder Name");

		RecycleBin.openRecycleBinAdmin(siteURLKey = "test-site-name");

		RecycleBin.viewCP(
			assetName = "WC Folder Name",
			assetType = "Web Content Folder",
			deleteUser = "Test Test");

		JSONWebcontent.addFolder(
			folderName = "WC Folder Name",
			groupName = "Test Site Name");

		WebContentNavigator.openWebContentAdmin(siteURLKey = "test-site-name");

		WebContentFolder.moveToRecycleBinCP(
			assetType = "Web Content Folder",
			folderName = "WC Folder Name");

		RecycleBin.openRecycleBinAdmin(siteURLKey = "test-site-name");

		RecycleBin.viewDuplicateNames(assetName = "WC Folder Name");
	}

	@priority = "3"
	test ViewRecycleBinEntryViaSuccessMessageLink {
		JSONWebcontent.addWebContent(
			content = "WC WebContent Content",
			groupName = "Test Site Name",
			title = "WC WebContent Title");

		WebContentNavigator.openWebContentAdmin(siteURLKey = "test-site-name");

		WebContent.moveToRecycleBinCP(
			assetType = "Web Content Article",
			webContentTitle = "WC WebContent Title");

		RecycleBin.gotoEntryViaSuccessMessage(assetName = "WC WebContent Title");

		RecycleBin.viewEntry(assetName = "WC WebContent Title");
	}

}